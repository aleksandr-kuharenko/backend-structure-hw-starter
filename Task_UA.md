*Вітаю! Ти вже не з чуток знаєш про структуру Backend'у, NodeJS та написання чистого, читабельного і якісного коду, але є одне "але"... Не всі проекти, що будуть траплятися на твоєму шляху, будуть написані розробниками, які знають про це стільки ж.*

## Задача
**Відрефакторити** [проект](https://github.com/aleksandr-kuharenko/backend-stucture-hw-starter), **зберігши** всю його функціональність (так-так, воно працює)

## Деталі проекту 
- Проект має тільки backend частину
- Весь функціонал працює і, навіть, покритий тестами. Як запустити сервер та автотести ти дізнаєшься з [README.md](https://github.com/aleksandr-kuharenko/backend-stucture-hw-starter/blob/master/README.md)
- На жаль, ніякої документації та описаних вимог до бізнес-логіки немає... Проте є код, а я кажуть: `The code is the documentation`  
![meme](https://i.ibb.co/cN2CmJx/meme1.jpg)
- Окрім запуску автотестів, розібратись з бізнес-логікою тобі допоможе 
Postman [колекція](https://github.com/aleksandr-kuharenko/backend-stucture-hw-starter/tree/master/postman). Ти можеш імпортувати її до себе у Postman, щоб побачити приклади HTTP запитів та використовувати їх для мануального тестування. 
 
Технології: 
- NodeJS + Express
- Postgres + [Knex](https://knexjs.org/)
- Docker
- [jsonwebtoken](https://www.npmjs.com/package/jsonwebtoken)
- [joi](https://www.npmjs.com/package/joi)
- [mocha](https://www.npmjs.com/package/mocha) (для тестів)

## Що необхідно зробити:
1. Розбити код на шари (шар бізнес-логіки, шар доступу до даних тощо)
2. Створити файлову структуру
3. Позбавитись від дублювання коду
4. Позбавитись від використання антипатернів
5. Виправити неоптимальні рішення (зайві запити до бази даних, непотрібні цикли)

**Увага**:
- index.js файл повинен експортувати instance Express серверу

Додаткові завдання:  

1. Підключити логгер (будь-який на [вибір](https://geshan.com.np/blog/2021/01/nodejs-logging-library/)). Для кожного запиту логувати:
    -  вхідні запити: url запиту, метод, час отримання запиту
    -  відповіді сервера: url запиту, метод, час обробки запиту, http код відповіді
2. Під час запуску сервера:
    - провалідувати чи всі змінні середовища вказані (якщо не всі — вивести повідомлення про помилку, завершити Node процес)
    — провалідувати підключення до бази даних (якщо підключитись не вдалося - вивести повідомлення про помилку, завершити Node процес)
3. Реалізувати [graceful shutdown](https://medium.com/hackernoon/graceful-shutdown-in-nodejs-2f8f59d1c357) 
4. Налаштувати [pre-commit](https://dev.to/ajmaurya/set-up-eslint-prettier-and-pre-commit-hooks-using-husky-for-wordpress-from-scratch-1djk) hook, який буде запускати [eslint](https://eslint.org/)  

## Що буде оцінюватися:

- Збереження функціональності проекту
- Чистота, читабельність та якість коду

Максимальний бал: 9.  
Ще один бал можна отримати за всі виконанні додаткові завдання.

---

*Вдалого рефакторингу!* 

![meme](https://i.ibb.co/5TqsWJ1/ref.png)
